# 表达式求值四个任务

## 一、进制转换

### 1、思路图

![](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417152209178.png)

### 2、注意事项

#### <1>类型转换问题

![image-20220417114802755](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417114802755.png)

①确定类型的时候，是什么类型就弄什么类型，最好不要混用，否则容易出错。

②char是字符型，内存中占用1个字节，取值范围是-128到127，int类型占用4个字节，范围就不说了，肯定是比char要大的多，这两个都是有符号数。
③char和int一般情况下是可以直接做加减运算的，可以直接把char当成一个int，只不过取值范围小点。

④在用%c输出的时候，注意ASCII码表的标准范围是0-127，这个情况下，字符和int可以相互转换，但是超了char所存储的范围他就从负数那边开始存了（转着圈存）。

### 3.遗留的问题

<1>想问怎么实现自适应存储数字。

![image-20220417120339064](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417120339064.png)

我在入栈的时候用的for循环，这个只能特定存储数字位数。

我想到一个方法就是用一个函数实现len（）的功能，把数字的位数数出来再填进去。

## 二、中缀转后缀表达式

### 1.思路图

![image-20220417130153814](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417130153814.png)

### 2.注意事项

#### <1>判断优先级方式

<img src="C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417121704090.png" alt="image-20220417121704090" style="zoom:67%;" />

根据优先级的高低返回不同的数值，在后面优先级比较的时候也比较方便。（返回的数字直接比较大小）

#### <2>发现用%S输出不了char类型的单个字符，但是%c可以

```c
char str[50];
printf("请输入中缀表达式：\n");	
gets(str); //这里用%s输出不了str[0]，但是能用%c不知道为啥
printf("%s",str[0]);
printf("%c",str[0]);
```

用%c运行结果

![image-20220417122757166](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417122757166.png)

用%s运行结果

![image-20220417123014502](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417123014502.png)

%s 格式输出 字符串， printf(“%s”，ch）；它从 ch 的 首地址里的字符开始输出。输完，输ch 地址加1地址里的字符，一直输出到遇到字符串结束符 '\0' 时输出才停止。
char类型的单个字符存储内部不含结束符。按%s输出时，地址一直增加，又找不到字符串结束符 '\0'， 所以程序会崩溃。
如果 char ch[]="a"; 则 printf(“%s”，ch）；就正确了。双引号括起的是字符串常量，含字符串结束符 '\0'.

#### <3>isdigit（）函数

头文件：#include <ctype.h>

定义函数：int isdigit(int c);

函数说明：检查参数 c 是否为阿拉伯数字0 到9。

返回值：若参数c 为阿拉伯数字，则返回true，否则返回null(0)。一般用在条件判断中。

举例：找出str 字符串中为阿拉伯数字的字符。

```c
#include <ctype.h>
main(){    
char str[] = "123@#FDsP[e?";//给出一个字符串    
int i;    
for(i = 0; str[i] != 0; i++)//遍历  
	if(isdigit(str[i]))//判断            
		printf("%c is an digit character\n", str[i]);//输出
}
```

执行结果：
1 is an digit character
2 is an digit character
3 is an digit character

**本次任务中的用法：**

![image-20220417124944176](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417124944176.png)

str【i】---输入的中缀表达式的单个字符。如果这个字符是数字，那么就直接输出，不是就进行下一步操作。

#### <4>输出#问题

![image-20220417125558556](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417125558556.png)

因为我是通过i去一个一个遍历字符串里的字符，而且我是想如果当前读取的字符是数字，那么就把这个数字读完再说。

所以如果当前读取的是数字，那么直接输出，同时判断下一个字符是不是数字，是数字就继续输出，不是数字就进行处理字符的操作。**再把图说一下。**

#### <5>根据优先级弹栈

```c
else if(str[i]==')') //遇到）
{
	while (Compare(ps->data[ps->pointer]) != 0)//根据优先级判断 
	{
		printf("%c",Pop(ps));//虽然搞了但是还是要输出！ 
    }
    Pop(ps);//把（删掉 
    i++;
}
```

因为前面写优先级的时候就把（和）的优先级都定义为0，所以判断的时候，遇到优先级为0就可以确定是（，通过这个就能把中间的符号都弹出去。

把中间符号的弹栈出去之后，最后再来一个把（弹出去就行了。

#### <6>很傻的输出问题

在对右括号的处理上，应该是把操作符弹出去然后输出，结果我弹出去忘了输出了，导致找了半天才找出来。所以大家在写任务的时候要注意自己的目的是啥，想实现什么效果，不忘初心！

## 三.后缀表达式求值

### 1.思路图

![image-20220417141430192](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417141430192.png)

### 2.注意事项

#### <1>字符串储存问题

​		中缀表达式可能求取的时候20个空就够了，但是后缀表达式可能就不够了，存不下就可能导致后面出问题。**所以定义数组存东西的时候要定义大一点。**

一开始我定义的char数组就有20个空，存后缀表达式只能存20个嘛，第二十一个是减号，显然存不进去，那么我去读取这个没有的值就出错了，甚至出现了同一个i读取结果不同的现象。**感觉很玄学，还是写规范的好，规范=没有bug。**

![image-20220417142322480](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417142322480.png)

同一个i，一个<,一个(

不过这里可能不同编译器结果就不同,可能别的编译器里会自动扩充什么的，那样运行结果就是对的。

#### <2>数字还原问题

**第一种方法**

```c
 while(isdigit(str[i])!=0 )
 {
           number=number*10+str[i]-'0';
     		//数字对应的ASCII码-'0'正好是对应的数字本身 
           i++;
           if(isdigit(str[i])==0)
           //如果下一个不是数字那么就把前面得到的数字入栈，然后进行下一步 
			{
				Push(ps,number);//入栈
				break;	
			}
}
```

因为要进行计算，所以数字读取的时候需要整个读取出来，我想了两种不过只用了一种。

读取数字利用的ASCII码的关系---> ‘9’-‘0’=9.

同样可以使用isdigit(str[i])函数去判断当前字符是不是数字。

**第二种方法**

```c
 while(isdigit(str[i])!=0 )//如果这个数是十进制数字，直接输出 ;如果是数字此函数返回非0值，否则返回0
	   {
		   number = atoi(str);//用这个函数能直接获取数字，但是只能是开头就是数字的，以非数字字符结尾 ---但是这个每次取完数字都需要把数字从数组里删除，比较麻烦 
		   //这里通过上面获取数字，用这个来计数，然后从数组里删除这几个数字 
		   flag=Count(number);//获取数字的长度 
		   printf("%d",number);
		   Push(ps,number);//把数字入栈
		   i=i+flag;
           i++;
           if(isdigit(str[i])==0)//如果下一个不是数字那么就把前面得到的数字入栈，然后进行下一步 
				{
					Push(ps,number);//入栈
					break;	
				}

	   }
```

在#include<stdlib.h>这个头文件里有个atoi()函数能够直接获取数字。

【函数说明】atoi() 函数会扫描参数 str 字符串，跳过前面的空白字符（例如空格，tab缩进等），直到遇上数字或正负符号才开始做转换，而再遇到非数字或字符串结束时('\0')才结束转换，并将结果返回。

【返回值】返回转换后的整型数；如果 str 不能转换成 int 或者 str 为空字符串，那么将返回 0。

我想的就是通过这个函数把数字获取出来，然后再去运算。一开始读取进来的表达式存在数组里了，所以每次读取数字完毕后需要读取这个数字的位数，把这个数字从字符串数字里删掉。比上面那个方法麻烦。

### 3.遗留问题

#### <1>number归零问题

在程序里面用了number这个变量去储存值，每次用完了需要归一下0，但是在程序结尾归零会报错，在程序开头归零就没事。

## 四、中缀表达式求值

### 1.思路图

![image-20220417150922619](C:\Users\lx\Documents\pycharm\王佳鑫学python第十九课\三国话痨王佳鑫\image-20220417150922619.png)

### 2.注意事项

#### <1>函数定义问题

```c
tan(int temp1,int temp2,int number,char ch2,stack ps1,stack ps2)
{
	void Push1(stack s, int c);//函数里套函数需要有一个声明 
	xxxxxxxxx//某运算
	Push1(ps1,number);//把计算好的值重新入栈
} 
```

数值栈弹栈运算再入栈---如果你定义的函数里套了另一个定义的函数，那么需要在这个函数内部对这个函数加上一个声明

### 