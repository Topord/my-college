# 数据结构任务分享

## **任务二：**中缀表达式转后缀表达式 

### 大体思路

申请**一个栈**(ps)用来存放操作符

1)将中缀字符串从左向右扫描；
2)如果是运算数,直接添加到输出串；
3)如果是左括号,把左括号入栈；
4)如果是运算符，则必须成为栈中等级最高的运算符才能入栈；
5)如果是右括号,则配对到左括号为止；
6)字符串扫描完毕，把栈取空。

### 细节

1）先对栈顶"指针"初始化-1，再入栈分隔符#

然后再扫描字符串的时候 伪指针就会从0开始

2）如果扫描到运算数,直接添加到输出字符串中，但先不加分隔符# 

因为可能是多位数

3）如果扫描到运算符，分为**两种情况**

第一种：运算符前一位是数

第二种：运算符前一位是反括号

**不同点**在于如果是第一种情况就需要把分隔符#加上，第二种则不需要

**相同点**都需要比较操作符与栈顶元素的等级，看看能不能入栈

4）如果扫描到的字符串最后一位是数字符就需要加上分隔符#

并且要把栈中符号全部取出 这一点与第一点对应



## 任务四：中缀表达式求值 

### 大体思路

申请**两个栈** (fh和num)    fh用来存放操作符 num用来存放数字符

1)将中缀字符串从左向右扫描；
2)如果是运算数,需要考虑多位数的情况然后存入数值栈；
3)如果是左括号,把左括号入符号栈；
4)如果是运算符，则必须成为栈中等级最高的运算符才能入栈；
5)如果是右括号,则配对到左括号为止，取出数值栈顶上两个数进行计算，然后把计算结果存入数值栈，把左括号弹出符号栈；
6)字符串扫描完毕，把栈取空。

### 细节

1）扫描到数字符时，对多位数的处理和将字符串型的数字转换为整型的方法 

```
		if(str[str_p]>='0' && str[str_p]<='9') 
		{
			sum = 0;
            sum = str[str_p] - '0';
            str_p++;   
            while (str[str_p] >= '0' && str[str_p] <= '9')
            {
                sum = sum * 10 + str[str_p] - '0';
                str_p++;
            }
            PushNum(num, sum);
		}
```

2）扫描到运算符时 取出符号栈顶进行比较时要考虑栈空的情况 

如果符号栈空就直接把扫描到的符号存入

如果符号栈顶部符号优先级高就取数计算，把计算结果存入数值栈，再把扫描的符号存入符号栈

如果符号栈顶部符号优先级低就把取出的栈顶和新扫描到的符号都再存入

3）判断等级的部分

```
char judge(char op1,char op2)  //op1放操作符  op2放符号栈顶部符号 
{
	int opp1=1,opp2=1;
	if(op1=='*' || op1=='/' ||(op2 =='(' && op1 != '('))
	{
		opp1++;
	}
	if(op2=='*' || op2=='/' ||(op1 =='(' && op2 != '('))
	{
		opp2++;
	}
	return ((opp1-opp2)>0?'>':'!');//操作符判断，如果op1优先级大于op2，返回'>'否则'!'
}
```

![79Z@W%ZSVFQ@M`OJL1%2L3K.png](https://img3.imgtp.com/2022/04/17/625bc7116e659.png) 

